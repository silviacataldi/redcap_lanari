(("undefined"!==typeof self?self:this)["webpackChunkcdp_mapping_vue"]=("undefined"!==typeof self?self:this)["webpackChunkcdp_mapping_vue"]||[]).push([[896],{2896:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return Re}});var a=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"text-justify"},[e("p",[t._v(t._s(t.translations["rws_description"]))]),e("p",[t._v(t._s(t.translations["rws_description_1"]))]),e("p",[e("span",[t._v(t._s(t.translations["rws_description_2"]))]),e("span",{staticClass:"d-block"},[e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.onTellMeMoreClicked.apply(null,arguments)}}},[t._v(t._s(t.translations["tell_me_more"])+".")])])]),"FHIR"==t.projectType?e("MappingHelperPanel",{staticClass:"my-2"}):t._e()],1),e("SettingsTable",{staticClass:"mb-2"}),e("MappingTable",{scopedSlots:t._u([{key:"head",fn:function(){return[e("ImportExport")]},proxy:!0}])}),e("SaveCancel",{staticClass:"mt-2"}),e("CDPInfoModal",{ref:"info-modal"})],1)},i=[],n=function(){var t=this,e=t._self._c;return e("div",[e("table",{ref:"table",staticClass:"table table-bordered table-hover"},[e("thead",{staticClass:"header thead-light"},[e("tr",[e("th",{attrs:{colspan:"6"}},[e("section",{staticClass:"d-flex flex-row justify-content-space-between align-items-center"},[e("span",{staticClass:"mr-auto"},[t._v(t._s(t.translations["mapping_table_title"]))]),t._t("head")],2)])]),e("tr",{directives:[{name:"show",rawName:"v-show",value:t.mapping.length>0,expression:"mapping.length>0"}],staticClass:"col-names"},[e("th",[e("span",{attrs:{title:t.fhirSourceName}},[t._v(t._s(t.translations["mapping_table_header_external_source"]))])]),e("th",[e("span",{attrs:{title:t.translations["mapping_table_header_event"]}},[t._v(t._s(t.translations["mapping_table_header_event"]))])]),e("th",[e("span",{attrs:{title:t.translations["mapping_table_header_field"]}},[t._v(t._s(t.translations["mapping_table_header_field"]))])]),e("th",[e("span",{attrs:{title:t.translations["mapping_table_header_date"]}},[t._v(t._s(t.translations["mapping_table_header_date"]))])]),e("th",[e("span",{attrs:{title:t.translations["mapping_table_header_preselect_strategy"]}},[t._v(t._s(t.translations["mapping_table_header_preselect_strategy"]))])]),e("th",[e("span",{attrs:{title:t.translations["mapping_table_header_actions"]}},[t._v(t._s(t.translations["mapping_table_header_actions"]))])])])]),e("transition-group",{attrs:{tag:"tbody",name:"list"}},[t._l(t.mapping,(function(s,a){return[e("tr",{directives:[{name:"show",rawName:"v-show",value:"deleted"!==s.status,expression:"item.status!=='deleted'"}],key:s.id,class:[t.getStatusClass(s),s===t.selected_mapping?"selected":""],attrs:{id:`row-${s.id}`}},[e("td",[s.disabled?e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-danger",attrs:{title:`${s.disabled_reason}`}},[e("font-awesome-icon",{attrs:{icon:["fas","exclamation-circle"],"fixed-width":""}})],1):t._e(),e("FhirFieldLabel",{class:{disabled:s.disabled},attrs:{identifier:s.is_record_identifier,name:s.fhir_field_name,label:s.fhir_label,category:s.category}})],1),e("td",[e("span",{attrs:{title:`Event ID: ${s.event_id}`}},[t._v(t._s(t.getEventName(s.event_id)))])]),e("td",[e("FieldLabel",{attrs:{title:`Field Name: ${s.field_name}`,field_name:s.field_name}})],1),e("td",[e("FieldLabel",{attrs:{title:`Temporal Field Name: ${s.temporal_field}`,field_name:s.temporal_field}})],1),e("td",[s.is_temporal?[e("PreselectLabel",{attrs:{value:s.preselect}})]:t._e()],2),e("td",{staticClass:"actions"},[e("div",{staticClass:"w-100 d-inline-flex flex-row align-items-center justify-content-end"},[e("b-button",{attrs:{id:`button-edit-${s.id}`,variant:"outline-secondary",size:"sm"},on:{click:function(e){return t.onEditClicked(s,a)}}},[e("font-awesome-icon",{staticClass:"text-primary",attrs:{icon:["fas","edit"]}})],1),e("b-tooltip",{attrs:{target:`button-edit-${s.id}`,placement:"bottom"}},[t._v("Edit")]),s.is_record_identifier?t._e():[e("b-button",{attrs:{id:`button-copy-${s.id}`,title:t.translations["ws_112"],variant:"outline-secondary",size:"sm"},on:{click:function(e){return t.onCopyClicked(s)}}},[e("font-awesome-icon",{attrs:{icon:["fas","copy"]}})],1),e("b-tooltip",{attrs:{target:`button-copy-${s.id}`,placement:"bottom"}},[t._v("Copy")])],[e("b-button",{attrs:{id:`button-delete-${s.id}`,title:t.translations["ws_115"],variant:"outline-secondary",size:"sm"},on:{click:function(e){return t.onDeleteClicked(s)}}},[e("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:["fas","times"]}})],1),e("b-tooltip",{attrs:{target:`button-delete-${s.id}`,placement:"bottom"}},[t._v("Delete")])]],2),s.has_errors?e("div",{staticClass:"alert alert-warning mt-2"},[e("span",{staticClass:"small"},[e("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" Revision needed")],1),e("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:`validation-errors-modal-${s.id}`,expression:"`validation-errors-modal-${item.id}`"}],attrs:{size:"sm"}},[t._v("details...")]),e("b-modal",{attrs:{id:`validation-errors-modal-${s.id}`,title:"Validation errors","ok-only":""}},[e("ul",t._l(s.validation_errors,(function(s,a){return e("li",{key:a},[e("span",[t._v(t._s(s))])])})),0)])],1):t._e(),t.mapping_duplicates.indexOf(s.id)>-1?e("div",{staticClass:"duplicate-warning"},[e("span",{staticClass:"small text-muted"},[e("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" duplicate")],1)]):t._e(),t.mapping_record_identifiers.indexOf(s.id)>0?e("div",{staticClass:"duplicate-warning"},[e("span",{staticClass:"small text-muted"},[e("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:["fas","exclamation-triangle"]}}),t._v(" record identifier already set")],1)]):t._e()])])]}))],2),e("tfoot",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{scope:"row",colspan:"6"}},[t._t("foot"),e("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button"},on:{click:t.onNewItemClicked}},[e("font-awesome-icon",{attrs:{icon:"plus-circle"}}),e("span",[t._v(" "+t._s(t.translations["find_more_sources_fields_to_map"]))])],1)],2)])])],1),e("b-modal",{attrs:{title:"Edit","hide-footer":""},model:{value:t.show_edit,callback:function(e){t.show_edit=e},expression:"show_edit"}},[e("MappingForm",{attrs:{mapping:t.getMappingConfig(t.selected_mapping)},scopedSlots:t._u([{key:"footer",fn:function({config:s,validation:a}){return[e("div",{staticClass:"d-flex justify-content-end"},[e("b-button",{staticClass:"me-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show_edit=!1}}},[t._v("Cancel")]),e("b-button",{attrs:{size:"sm",variant:"success",disabled:a.$invalid},on:{click:function(e){return t.update(t.selected_mapping,s)}}},[t._v("OK")])],1)]}}])})],1),e("b-modal",{attrs:{title:"Create","hide-footer":""},model:{value:t.show_create,callback:function(e){t.show_create=e},expression:"show_create"}},[e("MappingForm",{attrs:{mapping:t.new_mapping},scopedSlots:t._u([{key:"footer",fn:function({config:s,validation:a}){return[e("div",{staticClass:"d-flex justify-content-end"},[e("b-button",{staticClass:"me-2",attrs:{size:"sm",variant:"secondary"},on:{click:function(e){t.show_create=!1}}},[t._v("Cancel")]),e("b-button",{attrs:{size:"sm",variant:"success",disabled:a.$invalid},on:{click:function(e){return t.create(s)}}},[t._v("OK")])],1)]}}])})],1)],1)},o=[],r=function(){var t=this,e=t._self._c;return t.field_data?e("span",{attrs:{title:t.title}},[e("span",{staticClass:"d-block small font-weight-bold"},[t._v(t._s(t.field_data.field_name))]),e("span",{staticClass:"d-block",domProps:{innerHTML:t._s(t.field_data.element_label)}}),e("span",{staticClass:"d-block small muted font-italic"},[t._v("("+t._s(t.form_data.menu)+")")])]):t._e()},l=[],d={data(){return{field_data:{},form_data:{}}},computed:{},props:{field_name:{type:String,default:""},title:{type:String,default:""}},methods:{getFieldData(t){return this.$store.getters["app_settings/getFieldData"](t)},getFormData(t){return this.$store.getters["app_settings/getFormData"](t)}},watch:{field_name:{immediate:!0,handler(t){this.field_data=this.getFieldData(t);const{form_name:e}={...this.field_data};this.form_data=this.getFormData(e)}}}},c=d,p=s(1001),u=(0,p.Z)(c,r,l,!1,null,null,null),_=u.exports,f=function(){var t=this,e=t._self._c;return e("span",{staticClass:"fhir-field-label"},[t.identifier?[e("span",{staticClass:"identifier small me-2"},[t._v("("),e("font-awesome-icon",{staticClass:"text-warning",attrs:{icon:"star"}}),t._v(t._s(t.translations["source_identifier_field"])+")")],1)]:t._e(),e("span",{directives:[{name:"show",rawName:"v-show",value:t.name,expression:"name"}],staticClass:"small font-weight-bold"},[t._v(t._s(t.name))]),e("span",{staticClass:"d-block"},[t._v(t._s(t.label))]),t.category?e("span",{staticClass:"d-block font-italic small"},[t._v("("+t._s(t.category)+")")]):t._e()],2)},h=[],m={computed:{translations(){return this.$store.state.app_settings.translations}},props:{identifier:{type:Boolean,default:!1},name:{type:String,default:""},label:{type:String,default:""},category:{type:String,default:""}}},v=m,b=(s(8564),(0,p.Z)(v,f,h,!1,null,"03f6f364",null)),g=b.exports,w=function(){var t=this,e=t._self._c;return e("span",{domProps:{textContent:t._s(t.label)}})},y=[],x={computed:{options(){return this.$store.getters["app_settings/getPreselectOptions"]},label(){let t=this.options.find((t=>t.value===this.value));return t?t.label:""}},props:{value:{type:String,default:""}}},C=x,k=(0,p.Z)(C,w,y,!1,null,null,null),$=k.exports,j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"wrapper"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"fhir-field"}},[t._v(t._s(t.translations["mapping_table_header_external_source"]))]),e("FhirFieldsSelect",{model:{value:t.external_source_field_name,callback:function(e){t.external_source_field_name=e},expression:"external_source_field_name"}})],1),e("div",{staticClass:"form-group mt-2 d-flex redcap-event-field"},[e("div",[e("label",{},[t._v(t._s(t.translations["form_label_redcap_event"]))]),e("Events",{staticClass:"w-100",attrs:{options:t.arms,disabled:t.events_disabled},model:{value:t.event_id,callback:function(e){t.event_id=e},expression:"event_id"}})],1),e("div",{staticClass:"ms-2"},[e("label",{},[t._v(t._s(t.translations["form_label_redcap_field"]))]),e("Fields",{attrs:{options:t.getForms(t.event_id)},model:{value:t.redcap_field,callback:function(e){t.redcap_field=e},expression:"redcap_field"}})],1)]),e("div",{staticClass:"form-group mt-2 d-flex"},[e("div",{staticClass:"w-100"},[e("label",{attrs:{for:"datetime-field"}},[t._v(t._s(t.translations["form_label_date_time"]))]),e("Fields",{attrs:{options:t.groupedTemporalFields,disabled:t.disabledTemporal},model:{value:t.temporal_field,callback:function(e){t.temporal_field=e},expression:"temporal_field"}})],1),e("div",{staticClass:"w-100 ms-2"},[e("label",{attrs:{for:"preselect-field"}},[t._v(t._s(t.translations["form_label_preselect_strategy"]))]),e("SelectPreselectedValue",{attrs:{disabled:t.disabledTemporal},model:{value:t.preselect_value,callback:function(e){t.preselect_value=e},expression:"preselect_value"}})],1)]),e("footer",[t._t("footer",null,{config:t.config,validation:t.$v})],2)])},M=[],F=s(379),S=function(){var t=this,e=t._self._c;return e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"form-control-sm",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?s:s[0]}}},[e("option",{attrs:{value:""}},[t._v("-- none --")]),t._l(t.options,(function(s,a){return e("optgroup",{key:a,attrs:{label:a}},t._l(s||[],(function(s,a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(s))])})),0)}))],2)},O=[],P={computed:{selected:{get(){return this.value},set(t){this.$emit("input",t)}}},props:{options:{type:[Array,Object],default:()=>[]},value:{type:[Number,String],default:""}}},A=P,N=(0,p.Z)(A,S,O,!1,null,null,null),D=N.exports,Z=function(){var t=this,e=t._self._c;return e("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.label?e("span",{staticClass:"label"},[t._v(t._s(t.label))]):e("span",{staticClass:"label"},[t._v("Select...")])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),t._l(t.options||[],(function(s,a){return e("b-dropdown-item-button",{key:a,attrs:{active:s.value===t.selected},on:{click:function(e){t.selected=s.value}}},[e("span",[t._v(t._s(s.label))])])})),1)},I=[],z={computed:{selected:{get(){return this.value},set(t){this.$emit("input",t)}},label(){for(let{value:t,label:e}of this.options)if(t==this.value)return e;return!1},options(){const t=this.$store.getters["app_settings/getPreselectOptions"];return t}},props:{value:{type:[Number,String],default:null}}},T=z,E=(s(7426),(0,p.Z)(T,Z,I,!1,null,"059eeb96",null)),L=E.exports,H=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[e("b-dropdown",{ref:"dropdown",staticClass:"fhir-dropdown",attrs:{text:t.dropDownText,block:"",lazy:"",variant:"outline-secondary",size:"sm","menu-class":"w-100"},on:{shown:t.onDropdownShown}},[e("b-dropdown-form",[e("b-form-group",{staticClass:"my-0",attrs:{label:"","label-for":"filter-fields"},on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[e("b-form-input",{ref:"filter",attrs:{id:"filter-fields",size:"sm",placeholder:"filter fields...",autocomplete:"off"},on:{input:t.onFilterInput},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)],1),e("b-dropdown-text",[e("SelectNode",{attrs:{data:t.groups,id:"nodes"}})],1)],1)],1)},B=[],R=(s(7658),s(6486)),V=function(){var t=this,e=t._self._c;return t.hasVisibleChildren?e("div",{staticClass:"main",style:{marginLeft:20*(t.depth-1)+"px"}},[t.name?e("header",{staticClass:"group-head"},[e("div",{staticClass:"group-name",on:{click:t.toggleCollapse}},[e("font-awesome-icon",{staticClass:"me-1",class:{"fa-rotate-90":!t.collapsed},attrs:{icon:"angle-right"}}),t.name?e("strong",[t._v(t._s(t.name))]):t._e(),e("div",{staticClass:"small text-muted"},[t.hidden_fields.length>0?e("span",[t._v(" (showing "+t._s(t.visible_fields.length)+" of "+t._s(t.fields.length)+" field"+t._s(1==t.fields.length?"":"s")+")")]):t._e()])],1)]):t._e(),t.collapsed?t._e():[t._l(t.data,(function(s,a){return["field"in s&&!s.hidden?e("Leaf",{key:`cat_${a}`,attrs:{data:s},nativeOn:{click:function(e){return t.onLeafClicked(s)}}}):"field"in s?t._e():e("SelectNode",{key:`cat_${a}`,attrs:{name:a,data:s,depth:t.depth+1}})]}))]],2):t._e()},q=[],G=function(){var t=this,e=t._self._c;return e("div",{staticClass:"leaf"},[e("label",{attrs:{for:`checkbox_${t.data.field}`}},[e("span",{class:{disabled:t.data.disabled},domProps:{innerHTML:t._s(`• ${t.data.field} (${t.data.label})`)}}),e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:`${t.data.description}`}},[e("font-awesome-icon",{staticClass:"ms-2",attrs:{icon:"info-circle"}})],1)]),t.data.disabled?e("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"text-danger",attrs:{title:`${t.data.disabled_reason}`}},[e("font-awesome-icon",{attrs:{icon:["fas","exclamation-circle"],"fixed-width":""}})],1):t._e()])},Y=[],K={props:{data:{type:Object,default:()=>({})}}},J=K,Q=(s(7377),s(6502),(0,p.Z)(J,G,Y,!1,null,"4ddf346b",null)),U=Q.exports,W={name:"SelectNode",components:{Node:Node,Leaf:U},data(){return{is_collapsed:!0,metadata:{},selected:[]}},props:{data:{type:Object,default:()=>({})},depth:{type:Number,default:0},name:{type:String,default:""},value:{type:Object,default:null}},computed:{fields(){const{fields:t=[]}=this.metadata;return t},hidden_fields(){const{hidden_fields:t=[]}=this.metadata;return t},visible_fields(){const{fields:t=[],hidden_fields:e=[]}=this.metadata,s=t.filter((t=>e.indexOf(t)<0));return s},hasVisibleChildren(){return this.visible_fields.length>0},collapsed:{get(){return""!==this.name.trim()&&this.is_collapsed},set(t){this.is_collapsed=t}}},methods:{onLeafClicked(t){this.$root.$emit("fieldSelected",t)},toggleCollapse(){this.collapsed=!this.collapsed},parseChildren(t,e={fields:[],hidden_fields:[]}){for(let[s,a]of Object.entries(t))"object"==typeof a&&"field"in a?(e.fields.push(s),"hidden"in a&&1==a.hidden&&e.hidden_fields.push(s)):e=this.parseChildren(a,e);return e}},watch:{data:{immediate:!0,deep:!0,handler(t){this.metadata=this.parseChildren(t)}},visible_fields:{immediate:!0,deep:!0,handler(t,e){const s=this.$store.state.fhir_fields_select.filter;""==s.trim()?this.is_collapsed=!0:t.length>0&&(this.is_collapsed=!1)}}}},X=W,tt=(s(9726),(0,p.Z)(X,V,q,!1,null,"12afc25a",null)),et=tt.exports,st={components:{SelectNode:et},data(){return{filter:"",filtered_fields:[],groups:{}}},props:{value:{type:String,default:null}},created(){this.$root.$on("fieldSelected",this.onFieldSelected);const t=()=>{this.onFilterInput=(0,R.debounce)((t=>{this.setGroups()}),400)};t()},destroyed(){this.$root.$off("fieldSelected",this.onFieldSelected)},computed:{fields(){return this.$store.state.fhir_fields_select.fields},mapping(){return this.$store.state.mapping.list},dropDownText(){if(!this.fhir_field)return"Select...";const{field:t,description:e}=this.fhir_field;return`${t} (${e})`},fhir_field(){if(!this.selected)return;const t=this.$store.getters["app_settings/getFhirField"](this.selected);return t},selected:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{onDropdownShown(){const t=this.$refs.filter;t&&t.focus()},onFieldSelected(t){this.selected=t.field,this.$refs.dropdown.hide()},getSkipFields(){const t="id",e=[...this.mapping],s=[],a=e.some((e=>e.fhir_field_name===t));return a&&s.push(t),s},setGroups(){const t=[...this.fields];let e={};for(let s of t){if(s=this.applyFilter(this.filter,s),!s)continue;let t=s.category||"",a=s.subcategory||"",i=s.field||"";"undefined"===typeof e[t]&&(e[t]={}),""!=a.trim()?("undefined"===typeof e[t][a]&&(e[t][a]={}),e[t][a][i]=s):e[t][i]=s}this.groups={...e}},applyFilter(t,e){let s=new RegExp(`(${t})`,"ig"),a=[e.field,e.category,e.subcategory,e.label,e.description],i=a.some((t=>"string"===typeof t&&t.match(s)));return e.hidden=!i,e}},watch:{fields:{immediate:!0,handler(){this.setGroups()}}}},at=st,it=(s(9898),(0,p.Z)(at,H,B,!1,null,"702d5c25",null)),nt=it.exports,ot=function(){var t=this,e=t._self._c;return e("nav",{class:{show:t.show},attrs:{id:"dropdown",role:"navigation"}},[e("button",{on:{click:function(e){t.show=!t.show},blur:t.onBlur}},[t._v("events")]),e("ul",t._l(t.project.arms,(function(s,a){return e("li",{key:a},[e("span",[t._v(t._s(s.name))]),e("ul",t._l(s.events,(function(s,a){return e("li",{key:a},[e("span",[t._v(t._s(s.descrip))]),t.project.events_forms[a]?e("ul",t._l(t.project.events_forms[a],(function(s,a){return e("li",{key:a},[e("span",[t._v(t._s(t.project.forms[s].menu))]),e("ul",t._l(t.project.forms[s].fields,(function(s,a){return e("li",{key:a},[e("span",[t._v(t._s(s)+" ("+t._s(a)+")")])])})),0)])})),0):t._e()])})),0)])})),0)])},rt=[],lt={data(){return{open:[],show:!1}},computed:{project(){return this.$store.state.app_settings.project}},mounted:function(){this.$el.$on("bv::dropdown::show",(t=>{this.open.push(t.vueTarget)})),this.$el.$on("bv::dropdown::hide",(t=>{let e=this.open.indexOf(t.vueTarget);if(e<0||e==open.length-1){let t=[...this.open];t.splice(e,1),this.open=t}else{const e=this.$refs.wrapper.querySelectorAll("*:focus");e.length>0?t.preventDefault():this.open=[]}}))},methods:{onBlur(t){console.log(t)}}},dt=lt,ct=(s(3791),(0,p.Z)(dt,ot,rt,!1,null,"0cf6bb73",null)),pt=ct.exports,ut=function(){var t=this,e=t._self._c;return e("div",[e("section",{staticClass:"wrapper"},[t._t("event-header",(function(){return[e("span",{staticClass:"small"},[t._v("Event")])]})),e("Events",{attrs:{options:t.arms},model:{value:t.selected_event_id,callback:function(e){t.selected_event_id=e},expression:"selected_event_id"}})],2),e("section",{staticClass:"wrapper"},[t._t("field-header",(function(){return[e("span",{staticClass:"small"},[t._v("Field")])]})),e("Fields",{attrs:{options:t.forms},model:{value:t.selected_field_key,callback:function(e){t.selected_field_key=e},expression:"selected_field_key"}})],2)])},_t=[],ft=function(){var t=this,e=t._self._c;return e("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.label?e("span",{staticClass:"label"},[t._v(t._s(t.label))]):e("span",{staticClass:"label"},[t._v("Select...")])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),[t.options_length<1?e("b-dropdown-text",[t._v("No data")]):t._l(t.options,(function(s,a){return e("b-dropdown-group",{key:a},[e("b-dropdown-header",[e("span",[t._v(t._s(t.getArmLabel(a,s.name)))])]),t._l(s.events||[],(function(i,n){return e("b-dropdown-item-button",{directives:[{name:"show",rawName:"v-show",value:t.eventHasForms(n),expression:"eventHasForms(event_id)"}],key:n,attrs:{active:n===t.selected},on:{click:function(e){return t.onClick(n,s,a)}}},[e("span",[t._v(t._s(i.descrip)+" ("+t._s(t.getArmLabel(a,s.name))+")")])])})),e("b-dropdown-divider")],2)}))],2)},ht=[],mt={computed:{selected:{get(){return this.value},set(t){this.$emit("input",t)}},options_length(){const t=this.options;return Object.values(t).length},events_forms(){const{project:{events_forms:t={}}={}}=this.$store.state.app_settings;return t},events(){return this.$store.state.app_settings.project.events},label(){if(!this.events)return;const t=this.events[this.selected];if(!t)return;const{arm_num:e="",arm_name:s="",name:a=""}=t;return`${a} (Arm ${e}: ${s})`}},props:{options:{type:[Object],default:()=>({})},value:{type:[Number,String],default:""}},methods:{onClick(t,e,s){this.selected=t,this.arm_index=s,this.arm_name=e.name||""},eventHasForms(t){try{const e=this.events_forms[t]||[];return e.length>0}catch(e){return!1}},getArmLabel(t,e){return`Arm ${t}: ${e}`}}},vt=mt,bt=(s(4102),(0,p.Z)(vt,ft,ht,!1,null,"47cb2636",null)),gt=bt.exports,wt=function(){var t=this,e=t._self._c;return e("div",[e("b-dropdown",t._b({staticClass:"redcap-field-dropdown scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},on:{shown:t.onDropdownShown},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.selected?e("span",{staticClass:"label"},[t._v(t._s(t.selected))]):e("span",{staticClass:"label"},[t._v("Select..."+t._s(t.selected))])]},proxy:!0}])},"b-dropdown",t.$attrs,!1),[t.options_length<1?e("b-dropdown-text",[t._v("No data")]):[e("b-dropdown-form",[e("b-form-group",{staticClass:"my-0",attrs:{label:"","label-for":"filter-fields"},on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[e("b-form-input",{ref:"filter",attrs:{id:"filter-fields",size:"sm",placeholder:"filter fields...",autocomplete:"off"},on:{input:t.onFilterInput},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)],1),e("section",{staticClass:"content"},[e("b-dropdown-item-button",{attrs:{active:null==t.selected},on:{click:function(e){t.selected=null}}},[t._v("-- none --")]),t._l(t.filtered_options,(function(s,a){return e("b-dropdown-group",{key:a},[e("b-dropdown-header",{staticClass:"bg-light"},[e("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.getFormData(a).menu))])]),t._l(s||[],(function(s,a){return e("b-dropdown-item-button",{key:a,attrs:{title:s.element_label,active:t.selected===s.field_name},on:{click:function(e){t.selected=s.field_name}}},[e("span",[t._v(t._s(s.field_name))]),e("span",{staticClass:"d-block muted small font-italic",domProps:{innerHTML:t._s(s.element_label)}})])})),e("b-dropdown-divider")],2)}))],2)]],2)],1)},yt=[],xt={data(){return{filter:"",filtered_options:{}}},computed:{getFormData(){return this.$store.getters["app_settings/getFormData"]},selected:{get(){return this.value},set(t){this.$emit("input",t)}},options_length(){const t=this.options;return Object.values(t).length}},created(){const t=()=>{this.onFilterInput=(0,R.debounce)((t=>{this.filterOptions()}),400)};t()},props:{options:{type:[Object],default:()=>[]},value:{type:[Number,String],default:null}},methods:{filterOptions(){const t=this.filter;if(""===t.trim())return void(this.filtered_options={...this.options});const e={};for(let[s,a]of Object.entries(this.options)){const i=this.filterFormOptions(t,a);i.length>0&&(e[s]=i)}this.filtered_options={...e}},filterFormOptions(t,e){let s=[];const a=new RegExp(t,"i"),i=["element_label","field_name"];return e.forEach((t=>{let e=i.some((e=>t[e].match(a)));!1!==e&&s.push(t)})),s},isValueInOptions(){let t=[];for(let[s,a]of Object.entries(this.options))t=[...t,...a];const e=t.some((t=>t.field_name==this.value));return e||(this.selected=null),e},onDropdownShown(){const t=this.$refs.filter;t&&t.focus()}},watch:{options:{immediate:!0,handler(){this.filterOptions(),this.isValueInOptions()}}}},Ct=xt,kt=(s(3133),(0,p.Z)(Ct,wt,yt,!1,null,"791d3388",null)),$t=kt.exports,jt={components:{Events:gt,Fields:$t},props:{event:{type:String,default:""},field:{type:String,default:""}},computed:{project(){return this.$store.state.app_settings.project},groupedFields(){return this.$store.getters["app_settings/groupedProjectFields"]},selected_event_id:{get(){return this.event},set(t){const e={event:t,field:null};this.$emit("input",e)}},selected_field_key:{get(){return this.field},set(t){const e={event:this.event,field:t};this.$emit("input",e)}},arms(){const{arms:t}=this.project;return t},events_forms(){const{events_forms:t}=this.project;return t},forms(){const t=this.selected_event_id;return this.$store.getters["app_settings/getForms"](t)}}},Mt=jt,Ft=(s(6803),(0,p.Z)(Mt,ut,_t,!1,null,"f6b38814",null)),St=Ft.exports,Ot={components:{SelectProjectField:D,SelectPreselectedValue:L,FhirFieldsSelect:nt,EventFieldsDropDown:pt,RedcapFieldSelect:St,Fields:$t,Events:gt},data(){return{temporal_field:null,preselect_value:null,event_id:"",redcap_field:"",external_source_field_name:""}},props:{mapping:{type:Object,default:null}},computed:{translations(){return this.$store.state.app_settings.translations},project(){return this.$store.state.app_settings.project},project_id(){return this.$store.state.app_settings.project_id},groupedTemporalFields(){return this.$store.getters["app_settings/groupedProjectTemporalFields"]},events_disabled(){const t=parseInt(this.event_id);if(isNaN(t))return!1;const e=Object.keys(this.events),s=1===e.length;if(!s)return!1;const a=e.some((e=>t==e));return!!a},disabledTemporal(){return!this.fhir_field||1!=this.fhir_field.temporal},fhir_field(){if(!this.external_source_field_name)return{};const t=this.$store.getters["app_settings/getFhirField"](this.external_source_field_name);return t},arms(){return this.project.arms},events(){return this.project.events},config(){if(!this.fhir_field)return;const{field:t,identifier:e}=this.fhir_field,s={event_id:this.event_id,external_source_field_name:t,field_name:this.redcap_field,identifier:e,preselect:this.preselect_value,temporal_field:this.temporal_field};return s}},methods:{getForms(t){return this.$store.getters["app_settings/getForms"](t)}},watch:{mapping:{immediate:!0,handler(t){t&&(this.event_id=t.event_id,this.temporal_field=t.temporal_field,this.preselect_value=t.preselect,this.redcap_field=t.field_name,this.external_source_field_name=t.external_source_field_name)}},disabledTemporal:{immediate:!0,handler(t){t&&(this.temporal_field=null,this.preselect_value=null)}}},validations(){return{fhir_field:{required:F.C1},redcap_field:{required:F.C1}}}},Pt=Ot,At=(s(174),(0,p.Z)(Pt,j,M,!1,null,"782a8651",null)),Nt=At.exports,Dt=s(6171),Zt={components:{FieldLabel:_,FhirFieldLabel:g,PreselectLabel:$,MappingForm:Nt},data(){return{sort_by:null,modal_component:null,mapping_proxy:[],selected_mapping:null,show_edit:!1,show_create:!1,new_mapping:null}},computed:{translations(){return this.$store.state.app_settings.translations},fhirSourceName(){return this.$store.state.app_settings.fhir_source_name},project(){return this.$store.state.app_settings.project},project_temporal_fields(){return this.$store.state.app_settings.project_temporal_fields},fhir_fields(){return this.$store.state.app_settings.fhir_fields},mapping(){return this.$store.state.mapping.list},groupedTemporalFields(){return this.$store.getters["app_settings/groupedProjectTemporalFields"]},mapping_duplicates(){return this.$store.getters["mapping/duplicates"]},mapping_record_identifiers(){return this.$store.getters["mapping/recordIdentifiers"]},arms(){return this.project.arms},events(){return this.project.events}},methods:{getEventName(t){const e=this.$store.getters["app_settings/getEventData"](t);return"object"===typeof e&&"name_ext"in e?e.name_ext:""},onNewItemClicked(){const t={},e=Object.keys(this.events);1===e.length&&(t.event_id=e[0]),this.new_mapping={...t},this.show_create=!0},async updateMapping(t,e){await this.$store.dispatch("mapping/update",{item:t,params:e})},scrollToElement(t){if(!t)return;const e=t.getBoundingClientRect();let s=window.scrollY;window.scrollTo({top:s+e.top,behavior:"smooth"})},onDeleteClicked(t){this.$store.dispatch("mapping/deleteRow",t)},onCopyClicked(t){this.$store.dispatch("mapping/duplicateRow",t)},onEditClicked(t,e){this.selected_mapping=t,this.show_edit=!0},update(t,e){this.show_edit=!1,this.updateMapping(t,e)},async create(t){await this.$store.dispatch("mapping/addRow",t);this.show_create=!1},getStatusClass(t){const{status:e=""}=t;let s="status-";switch(e){case"new":s+="new";break;default:s+="normal";break}return t.dirty&&(s+=" dirty"),s},async sortBy(t){this.sort_by=await this.$store.dispatch("mapping/sortBy",t)},getMappingConfig(t){return t instanceof Dt.v?t.config:{}}}},It=Zt,zt=(s(8077),(0,p.Z)(It,n,o,!1,null,"a55dea78",null)),Tt=zt.exports,Et=function(){var t=this,e=t._self._c;return e("div",[e("table",{staticClass:"table table-bordered"},[e("thead",{staticClass:"thead-light"},[e("tr",[e("th",{attrs:{colspan:"2"}},[e("span",[t._v(t._s(t.translations["settings_table_title"]))])])])]),e("tbody",[e("tr",[e("td",[e("h6",[t._v(t._s(t.translations["preview_fields_title"]))]),e("p",[t._v(t._s(t.translations["preview_fields_description"]))])]),e("td",[e("label",{attrs:{for:"select-preview-field"}},[e("span",[t._v(t._s(t.translations["preview_fields_select_label"]))]),t._v(" "),e("em",[t._v(t._s(t.fhirSourceName))]),t._v(" "),e("span",[t._v(t._s(t.translations["preview_fields_select_up_to"]))])]),e("PreviewFields")],1)]),e("tr",[e("td",[e("h6",[t._v(t._s(t.translations["default_day_offset_title"]))]),e("p",[t._v(t._s(t.translations["default_day_offset_description"]))])]),e("td",[e("label",{attrs:{for:"day-offset"}},[t._v(t._s(t.translations["default_day_offset_label"]))]),e("DaysOffset")],1)]),e("tr",[e("td",[e("h6",[t._v(t._s(t.translations["instant_adjudication_title"]))]),e("p",[t._v(t._s(t.translations["instant_adjudication_description"]))])]),e("td",[e("label",{staticClass:"me-2",attrs:{for:"auto-adjudication"}},[t._v(t._s(t.translations["instant_adjudication_label"]))]),e("AutoAdjudication")],1)])])])])},Lt=[],Ht=function(){var t=this,e=t._self._c;return e("div",[t._l(t.preview_fields,(function(s,a){return e("section",{key:a,staticClass:"mb-2"},[e("b-button-group",{staticClass:"w-100"},[e("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",left:"",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[e("span",{staticClass:"label"},s?[t._v(t._s(s))]:[t._v("Select...")])]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.options_length<1?e("b-dropdown-text",[t._v("No data")]):t._l(t.awailable_preview_fields,(function(i,n){return e("b-dropdown-group",{key:`cat-${n}`},[e("b-dropdown-header",[e("span",[t._v(t._s(n))])]),t._l(i||[],(function(i,n){return e("b-dropdown-item-button",{key:`${n}-${i.field}`,attrs:{active:i.field===s,NOT_disabled:"preview_fields.indexOf(item.field)>=0"},on:{click:function(e){return t.onSetFieldClicked(a,i.field)}}},[e("span",[t._v(t._s(i.label))])])})),e("b-dropdown-divider")],2)}))],2),e("b-button",{staticClass:"delete-button",attrs:{size:"sm",variant:"outline-secondary",NOT_disabled:"total_preview_fields<=1"},on:{click:function(e){return t.onDeletePreviewFieldClicked(a)}}},[e("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:"times"}})],1)],1)],1)})),e("b-button",{staticClass:"mt-0",attrs:{variant:"success",size:"sm",disabled:t.total_preview_fields>=t.max_preview_fields},on:{click:t.onAddPreviewFieldClicked}},[e("font-awesome-icon",{attrs:{icon:"plus-circle"}}),e("span",[t._v(" "+t._s(t.translations["preview_fields_add_another_field"]))])],1)],2)},Bt=[],Rt=function(){var t=this,e=t._self._c;return e("b-dropdown",t._b({staticClass:"scrollable",attrs:{size:"sm",lazy:"",block:"",variant:"outline-secondary"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._t("button-content",(function(){return[t.selected?e("span",{staticClass:"label"},[t._v(t._s(t.selected))]):e("span",{staticClass:"label"},[t._v("Select a field...")])]}))]},proxy:!0}],null,!0)},"b-dropdown",t.$attrs,!1),[t.options_length<1?e("b-dropdown-text",[t._v("No data")]):[t._t("default",(function(){return t._l(t.options||[],(function(s,a){return e("b-dropdown-item-button",{key:a,attrs:{active:a===t.selected},on:{click:function(e){t.selected=a}}},[e("span",[t._v(t._s(s))])])}))}))]],2)},Vt=[],qt={computed:{selected:{get(){return this.value},set(t){this.$emit("input",t)}},options_length(){const t=this.options;return Array.isArray(t)?t.length:Object.values(t).length}},props:{options:{type:[Object,Array],default:()=>[]},value:{type:[Number,String],default:""}}},Gt=qt,Yt=(s(9110),(0,p.Z)(Gt,Rt,Vt,!1,null,"6d35b686",null)),Kt=Yt.exports,Jt={components:{DropDown:Kt},data(){return{max_preview_fields:5}},computed:{preview_fields(){return this.$store.state.settings.preview_fields},translations(){return this.$store.state.app_settings.translations},awailable_preview_fields(){return this.$store.getters["app_settings/previewFields"]},options_length(){const t=this.awailable_preview_fields;return Array.isArray(t)?t.length:Object.values(t).length},total_preview_fields(){return[...this.preview_fields].length}},methods:{onSetFieldClicked(t,e){this.$store.dispatch("settings/setPreviewField",{index:t,field:e})},onAddPreviewFieldClicked(){this.$store.dispatch("settings/addPreviewField")},onDeletePreviewFieldClicked(t){this.$store.dispatch("settings/deletePreviewField",t)}}},Qt=Jt,Ut=(s(723),(0,p.Z)(Qt,Ht,Bt,!1,null,"45462dce",null)),Wt=Ut.exports,Xt=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"form-inline"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.day_offset_plusminus,expression:"day_offset_plusminus"}],staticClass:"form-control ms-0",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.day_offset_plusminus=e.target.multiple?s:s[0]}}},[e("option",{attrs:{value:"+-"}},[t._v("±")]),e("option",{attrs:{value:"+"}},[t._v("+")]),e("option",{attrs:{value:"-"}},[t._v("-")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.day_offset,expression:"day_offset"}],staticClass:"form-control ms-2",attrs:{type:"number",id:"day-offset",min:t.day_offset_min,max:t.day_offset_max,step:t.day_offset_min,required:""},domProps:{value:t.day_offset},on:{input:function(e){e.target.composing||(t.day_offset=e.target.value)}}}),e("span",{staticClass:"ms-2"},[t._v(t._s(t.translations["days"]))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.day_offset,expression:"day_offset"}],staticClass:"custom-range",attrs:{type:"range",min:t.day_offset_min,max:t.day_offset_max,step:t.day_offset_min},domProps:{value:t.day_offset},on:{__r:function(e){t.day_offset=e.target.value}}})]),e("span",[t._v(t._s(t.day_offset_text))])])},te=[],ee={data(){return{}},computed:{translations(){return this.$store.state.app_settings.translations},day_offset_min(){return this.$store.state.app_settings.day_offset_min},day_offset_max(){return this.$store.state.app_settings.day_offset_max},day_offset:{get(){return this.$store.state.settings.realtime_webservice_offset_days},set(t){this.$store.dispatch("settings/setOffsetDays",t)}},day_offset_plusminus:{get(){return this.$store.state.settings.realtime_webservice_offset_plusminus},set(t){this.$store.dispatch("settings/setOffsetPlusminus",t)}},day_offset_text(){let t=this.translations.min_max_days;if(!t)return;const e={min_days:this.day_offset_min,min_minutes:Math.ceil(14.4),max_days:this.day_offset_max};for(let[s,a]of Object.entries(e))t=t.replace(`{{${s}}}`,a);return t}}},se=ee,ae=(0,p.Z)(se,Xt,te,!1,null,null,null),ie=ae.exports,ne=function(){var t=this,e=t._self._c;return e("div",[t.is_allowed?t._e():e("div",{staticClass:"alert alert-warning"},[e("span",{staticClass:"font-weight-bold d-block"},[t._v("Attention")]),e("span",[t._v("Instant adjudication is disabled in REDCap. Please enable it in the CDIS setting page if you want to use this feature.")])]),e("div",[e("b-dropdown",{staticClass:"d-block",attrs:{variant:t.auto_adjudication_enabled?"success":"danger",disabled:!t.can_be_enabled,size:"sm"},scopedSlots:t._u([{key:"button-content",fn:function(){return[t.auto_adjudication_enabled?e("span",{staticClass:"label"},[t._v(t._s(t.translations["instant_adjudication_enabled"]))]):e("span",{staticClass:"label"},[t._v(t._s(t.translations["instant_adjudication_disabled"]))])]},proxy:!0}])},[e("b-dropdown-item-button",{attrs:{active:0==t.auto_adjudication_enabled},on:{click:function(e){return t.setAutoAdjudication(!1)}}},[e("span",[e("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:"minus-circle"}}),t._v(" "+t._s(t.translations["instant_adjudication_disabled_text"]))],1)]),e("b-dropdown-item-button",{attrs:{active:1==t.auto_adjudication_enabled},on:{click:function(e){return t.setAutoAdjudication(!0)}}},[e("span",[e("font-awesome-icon",{staticClass:"text-success",attrs:{icon:"check-circle"}}),t._v(" "+t._s(t.translations["instant_adjudication_enabled_text"]))],1)])],1),e("span",{domProps:{innerHTML:t._s(t.total_selected_fields_text)}})],1),t.can_be_enabled?t._e():e("span",{staticClass:"small text-muted"},[t._v(t._s(t.translations["instant_adjudication_disabled_description"]))]),e("div",{staticClass:"mt-4"},[e("span",{staticClass:"font-weight-bold d-block"},[t._v(t._s(t.translations["instant_adjudication_cronjob_settings_title"]))]),e("b-form-checkbox",{attrs:{id:"cronjob",switch:"",disabled:!t.auto_adjudication_enabled},model:{value:t.cronjob,callback:function(e){t.cronjob=e},expression:"cronjob"}},[e("label",{attrs:{for:"cronjob"}},[t._v(t._s(t.translations["instant_adjudication_cronjob_settings_label"]))])]),e("span",[t._v(t._s(t.translations["instant_adjudication_cronjob_settings_description"]))])],1)])},oe=[],re={data(){return{}},computed:{cronjob:{get(){return Boolean(this.$store.state.settings.fhir_cdp_auto_adjudication_cronjob_enabled)},set(t){this.$store.dispatch("settings/setAutoAdjudicationCronjob",t)}},translations(){return this.$store.state.app_settings.translations},total_selected_fields_text(){if(0===this.temporal_mapping.length)return"";let t=this.translations.instant_adjudication_total_selected_fields;if(!t)return;const e={fields:this.enabled_temporal_mapping.length,total_fields:this.temporal_mapping.length};for(let[s,a]of Object.entries(e))t=t.replace(`{{${s}}}`,`<strong>${a}</strong>`);return t},temporal_mapping(){const t=this.$store.getters["mapping/activeList"];return t.filter((t=>t.is_temporal))},enabled_temporal_mapping(){const t=this.temporal_mapping,e=t.filter((t=>{const{temporal_field:e,preselect:s}=t;return 0!=Boolean(e)&&0!=Boolean(s)}));return e},can_be_enabled(){if(0===this.temporal_mapping.length)return!0;if(this.enabled_temporal_mapping.length<1)return!1;const t=this.temporal_mapping.length===this.enabled_temporal_mapping.length;return Boolean(this.is_allowed&&t)},is_allowed(){const t=this.$store.state.app_settings.project,{fhir_cdp_auto_adjudication_allowed:e,fhir_cdp_auto_adjudication_enabled:s}=t;return e},auto_adjudication_enabled:{get(){return 1==this.$store.state.settings.fhir_cdp_auto_adjudication_enabled},set(t){this.setAutoAdjudication(t)}}},methods:{setAutoAdjudication(t){this.$store.dispatch("settings/setAutoAdjudication",t)}},watch:{can_be_enabled:{immediate:!0,handler(t){!1===t&&this.setAutoAdjudication(!1)}}}},le=re,de=(0,p.Z)(le,ne,oe,!1,null,null,null),ce=de.exports,pe={components:{PreviewFields:Wt,DaysOffset:ie,AutoAdjudication:ce},data(){return{auto_adjudication:!1,preview_fields:[]}},computed:{translations(){return this.$store.state.app_settings.translations},fhirSourceName(){return this.$store.state.app_settings.fhir_source_name},project(){return this.$store.state.app_settings.project},fhir_cdp_auto_adjudication_enabled(){return this.$store.state.app_settings.project.fhir_cdp_auto_adjudication_enabled},project_preview_fields(){return this.$store.getters["settings/previewFields"]}},watch:{fhir_cdp_auto_adjudication_enabled:{immediate:!0,handler(t){this.auto_adjudication=Boolean(t)}}}},ue=pe,_e=(s(6987),(0,p.Z)(ue,Et,Lt,!1,null,"2fd68bd7",null)),fe=_e.exports,he=function(){var t=this,e=t._self._c;return e("div",[e("b-button-group",[e("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.importClicked}},[e("font-awesome-icon",{attrs:{icon:"file-import"}}),t._v(" Import")],1),e("b-button",{attrs:{variant:"outline-primary",size:"sm"},on:{click:t.exportClicked}},[e("font-awesome-icon",{attrs:{icon:"file-export"}}),t._v(" Export")],1)],1),e("input",{ref:"file",staticClass:"d-none",attrs:{type:"file"},on:{change:t.onFileChanged}}),e("b-modal",{attrs:{id:"download-modal",title:"Mapping export","ok-title":"Download","button-size":"sm"},on:{ok:t.onDownloadOkClicked}},[e("div",{staticClass:"text-center"},[e("h6",{staticClass:"my-4"},[t._v("Your data is ready to be downloaded!")]),e("div",{staticClass:"d-flex flex-column align-content-center justify-content-center"},[e("a",{staticClass:"mx-auto text-center text-primary",attrs:{href:t.download_url,download:""}},[e("font-awesome-icon",{attrs:{icon:"file-csv",size:"5x"}}),e("span",{staticClass:"d-block"},[t._v("click here to download")])],1)])])])],1)},me=[],ve={data(){return{download_url:null}},methods:{importClicked(){this.$refs.file.value=null,this.$refs.file.click()},async onFileChanged(t){const e=this.$refs.file.files;if(!(e.length<1))try{const t=e[0],s=await this.$API.dispatch("settings/importMapping",t),{data:{imported:a=[]}={}}=s,i=a.length,n=`Total imported mapping: ${i}`,o="Import process completed";await this.$bvModal.msgBoxOk(n,{title:o}),this.$root.$emit("settings:updated")}catch(s){let t="";if("string"===typeof s)t=s;else{const{response:{data:e={}}={}}=s;t=e.message||"error importing data"}const e="Import error";this.$bvModal.msgBoxOk(t,{title:e})}},async exportClicked(){this.download_url=null;const t=await this.$API.dispatch("settings/exportMapping"),{data:{download_url:e=""}={}}=t;this.download_url=e,this.$bvModal.show("download-modal")},onDownloadOkClicked(){this.download_url&&location.replace(this.download_url)}}},be=ve,ge=(0,p.Z)(be,he,me,!1,null,null,null),we=ge.exports,ye=function(){var t=this,e=t._self._c;return e("div",[t.mapping_has_errors?e("div",{staticClass:"alert alert-warning d-block"},[e("span",[t._v("Attention: the current configuration needs to be revisioned. Please check the table for more information.")])]):t._e(),1!==t.recordIdentifiersInMapping.length?e("div",{staticClass:"alert alert-warning d-block"},[t.recordIdentifiersInMapping.length<1?e("span",[t._v("Attention: one field must be mapped to the 'source identifier field'.")]):e("span",[t._v("Attention: only one field can be mapped to the 'source identifier field', but "+t._s(t.recordIdentifiersInMapping.length)+" have been set.")])]):t._e(),t.duplicates_detected?e("div",{staticClass:"alert alert-warning d-block"},[t._v(" Attention: duplicates detected. Please check the table for more information. ")]):t._e(),e("div",{staticClass:"d-flex flex-row justify-content-center align-items-center text-center"},[e("button",{staticClass:"btn btn-outline-success",attrs:{type:"button",disabled:t.save_disabled},on:{click:t.onClickSave}},[e("font-awesome-icon",{attrs:{icon:"save"}}),t._v(" Save")],1),e("button",{staticClass:"btn btn-outline-secondary m-2",attrs:{type:"button"},on:{click:t.onClickCancel}},[e("font-awesome-icon",{attrs:{icon:"times-circle"}}),t._v(" Cancel")],1)]),e("b-modal",{attrs:{id:"save-modal",title:"Success","ok-only":""},on:{hidden:t.onSaveModalHidden}},[e("p",{staticClass:"my-4"},[t._v("Settings saved!")])]),e("b-modal",{attrs:{id:"error-modal",title:"Error","ok-only":""},on:{hidden:t.onErrorModalHidden}},[e("p",{staticClass:"my-4"},[t._v("There was an error saving the settings!")]),e("ul",t._l(t.error,(function(s,a){return e("li",{key:a},[t._v(t._s(a)+": "+t._s(s))])})),0)])],1)},xe=[];const Ce={error:null};var ke={data(){return{...Ce}},created(){window.addEventListener("beforeunload",this.saveBeforeLeaving)},destroyed(){window.removeEventListener("beforeunload",this.saveBeforeLeaving)},computed:{project(){return this.$store.state.app_settings.project},mapping(){return this.$store.state.mapping.list},preview_fields(){return this.$store.state.settings.preview_fields},fhir_cdp_auto_adjudication_enabled(){return this.$store.state.settings.fhir_cdp_auto_adjudication_enabled},fhir_cdp_auto_adjudication_cronjob_enabled(){return this.$store.state.settings.fhir_cdp_auto_adjudication_cronjob_enabled},realtime_webservice_offset_days(){return this.$store.state.settings.realtime_webservice_offset_days},realtime_webservice_offset_plusminus(){return this.$store.state.settings.realtime_webservice_offset_plusminus},recordIdentifiersInMapping(){return this.$store.getters["mapping/recordIdentifiers"]},mappingConfigurationErrors(){return this.$store.getters["mapping/getConfigurationErrors"]},mapping_duplicates(){return this.$store.getters["mapping/duplicates"]},mapping_is_dirty(){return this.$store.getters["mapping/is_dirty"]},duplicates_detected(){return this.mapping_duplicates.length>0},mapping_has_errors(){let t=this.mappingConfigurationErrors;return t.length>0},save_disabled(){const t=this.recordIdentifiersInMapping.length;return Boolean(this.mapping_has_errors||1!==t||this.duplicates_detected)}},methods:{async saveBeforeLeaving(t){if(!this.mapping_is_dirty)return!0;t.preventDefault();const e="You have unsaved mapping; please confirm that you want to leave this page without saving.";t.returnValue=e},reset(){for(let[t,e]of Object.entries(Ce))this[t]=e},showSuccessModal(){this.$bvModal.show("save-modal")},onSaveModalHidden(){this.$root.$emit("settings:saved")},onErrorModalHidden(){this.$root.$emit("settings:error")},async onClickSave(){try{this.reset();const t={preview_fields:this.preview_fields,fhir_cdp_auto_adjudication_enabled:this.fhir_cdp_auto_adjudication_enabled,fhir_cdp_auto_adjudication_cronjob_enabled:this.fhir_cdp_auto_adjudication_cronjob_enabled,realtime_webservice_offset_days:this.realtime_webservice_offset_days,realtime_webservice_offset_plusminus:this.realtime_webservice_offset_plusminus},e=[...this.mapping];await this.$API.dispatch("settings/set",{settings:t,mapping:e});this.$bvModal.show("save-modal")}catch(t){const{response:{data:e={}}={}}=t;this.error=e,this.$bvModal.show("error-modal"),console.error(t.toJSON()),console.error(t)}},onClickCancel(){this.$root.$emit("settings:canceled")}}},$e=ke,je=(s(4821),(0,p.Z)($e,ye,xe,!1,null,"cd1c4828",null)),Me=je.exports,Fe=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{"title-html":t.title,"ok-only":"",size:"lg"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("div",{domProps:{innerHTML:t._s(t.content)}})])},Se=[],Oe={data(){return{title:"",content:"",visible:!1}},methods:{async open(){await this.getInfo(),this.visible=!0},async getInfo(){let t=null;try{t=this.$store.state.app_settings.project.realtime_webservice_type}catch(i){t="fhir"}const e=await this.$API.dispatch("settings/getInfoPage",t),{data:{title:s="",content:a=""}={}}=e;this.title=s,this.content=a}}},Pe=Oe,Ae=(0,p.Z)(Pe,Fe,Se,!1,null,null,null),Ne=Ae.exports,De=function(){var t=this,e=t._self._c;return e("div",[e("span",{staticClass:"d-block",domProps:{innerHTML:t._s(t.text_with_links)}}),e("b-button",{staticClass:"text-white",attrs:{href:t.mapping_helper_url,variant:"info",size:"sm"}},[e("font-awesome-icon",{attrs:{icon:["fas","code-branch"]}}),e("span",[t._v(" Mapping Helper")])],1)],1)},Ze=[],Ie={computed:{translations(){return this.$store.state.app_settings.translations},mapping_helper_url(){return this.$store.state.app_settings.mapping_helper_url},text(){const{cdp_settings_mapping_helper_text:t=""}=this.translations;return t},text_with_links(){let t=String(this.text),e="Mapping Helper";const s=new RegExp(e,"ig"),a=this.mapping_helper_url,i=`<a href="${a}">${e}</a>`,n=t.replace(s,i);return n}}},ze=Ie,Te=(0,p.Z)(ze,De,Ze,!1,null,null,null),Ee=Te.exports,Le={components:{MappingTable:Tt,SettingsTable:fe,ImportExport:we,SaveCancel:Me,MappingHelperPanel:Ee,CDPInfoModal:Ne},computed:{translations(){return this.$store.state.app_settings.translations},mapping_helper_url(){return this.$store.state.app_settings.mapping_helper_url},projectType(){return this.$store.getters["app_settings/projectType"]}},methods:{onTellMeMoreClicked(){const t=this.$refs["info-modal"];t&&t.open()}}},He=Le,Be=(0,p.Z)(He,a,i,!1,null,null,null),Re=Be.exports},2545:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,"",""]),e["default"]=r},7551:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".label[data-v-6d35b686]{display:block;overflow:hidden;max-height:70%;text-overflow:ellipsis}.scrollable[data-v-6d35b686] ul[role=menu]{max-height:50vh;overflow:auto}.scrollable[data-v-6d35b686] button.dropdown-toggle{display:flex;flex-direction:row;justify-content:space-between;align-items:center}",""]),e["default"]=r},1461:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,'#dropdown[data-v-0cf6bb73]{position:relative;display:inline-block;z-index:1;font-weight:400;font-size:16px}#dropdown.show>button[data-v-0cf6bb73]{background-color:rgba(0,0,0,.1)}#dropdown>button[data-v-0cf6bb73]{background-color:transparent;margin-bottom:4px;border-style:solid;border-width:1px;border-color:#6c757d;border-radius:3px;padding:.375rem .75rem;display:inline-flex;align-items:center}#dropdown>button[data-v-0cf6bb73]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:"";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}#dropdown.show>ul[data-v-0cf6bb73]{display:block}#dropdown ul[data-v-0cf6bb73]{margin-top:-2px;background-color:#fff;padding:.5rem 0;display:none;border-radius:3px;color:#6c757d;border-style:solid;border-width:1px;border-color:#6c757d;left:0;position:absolute;top:0;left:80%;z-index:1}#dropdown>ul[data-v-0cf6bb73]{top:100%;left:0}li[data-v-0cf6bb73]{padding:.25rem 1.5rem;position:relative;white-space:nowrap;min-width:200px;color:#000}#dropdown li:hover>ul[data-v-0cf6bb73],li[data-v-0cf6bb73]{display:block}#dropdown li[data-v-0cf6bb73]:hover{cursor:pointer;background-color:#f8f9fa}',""]),e["default"]=r},1734:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,"mark{padding:0}",""]),e["default"]=r},164:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".leaf label .disabled[data-v-4ddf346b]{text-decoration:line-through}.leaf[data-v-4ddf346b]{display:flex;flex-direction:row;align-items:center;padding:3px 0}.leaf[data-v-4ddf346b]:hover{background-color:rgba(0,0,0,.1)}.leaf>*[data-v-4ddf346b]{cursor:pointer;display:block;margin:auto 0}.leaf label[data-v-4ddf346b]{margin-left:5px}",""]),e["default"]=r},3699:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".fhir-dropdown[data-v-702d5c25] button.dropdown-toggle{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#nodes[data-v-702d5c25]{max-height:300px;font-size:14px;overflow-y:scroll;text-align:left}.dropdown-menu-ref[data-v-702d5c25]{max-height:300px;overflow-y:auto}",""]),e["default"]=r},2049:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".group-head[data-v-12afc25a],.wrapper[data-v-12afc25a]{display:flex;flex-direction:row}.group-head[data-v-12afc25a]{justify-content:space-between;align-items:center}.main+.main[data-v-12afc25a]{padding-top:10px}.main[data-v-12afc25a]:not(:last-of-type){border-bottom:1px solid #cacaca}.group-name[data-v-12afc25a]{padding:10px 0;cursor:pointer}",""]),e["default"]=r},4021:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".redcap-event-field>div[data-v-782a8651]{flex:1}.redcap-field[data-v-782a8651]{display:flex;flex-direction:row}label[data-v-782a8651]{font-weight:700;font-size:80%}",""]),e["default"]=r},7150:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".fhir-field-label.disabled[data-v-03f6f364]{text-decoration:line-through}",""]),e["default"]=r},2760:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,'.actions[data-v-a55dea78]{vertical-align:middle}.actions button+button[data-v-a55dea78]{margin-left:4px}.events-fields[data-v-a55dea78]{display:flex;justify-content:center;flex-direction:column}span[title][data-v-a55dea78]{cursor:help}.category[data-v-a55dea78]{background-color:rgba(0,0,0,.05);font-weight:700;color:darkred}.selected[data-v-a55dea78]{background-color:rgba(0,123,252,.2)}tr td[data-v-a55dea78]{position:relative}tr.status-new[data-v-a55dea78]{background-color:rgba(200,255,200,.5)}tr.status-deleted td[data-v-a55dea78]:not(.actions){pointer-events:none;opacity:.5;text-decoration:line-through}tr.dirty[data-v-a55dea78]{background-color:rgba(255,255,200,.5)}tr.dirty>td[data-v-a55dea78]:first-child:before{content:"";position:absolute;top:0;left:0;height:100%;width:2px;background-color:red}tr.status-new>td[data-v-a55dea78]:first-child:before{content:"";position:absolute;top:0;left:0;height:100%;width:2px;background-color:green}.list-enter-active[data-v-a55dea78],.list-leave-active[data-v-a55dea78]{transition:all .5s}.list-move[data-v-a55dea78]{transition:transform 1s}.list-enter-active[data-v-a55dea78]{background-color:rgba(200,255,200,.5)}.list-enter-to[data-v-a55dea78]{background-color:hsla(0,0%,100%,0)}.list-leave-active[data-v-a55dea78]{background-color:#ffc8c8}.list-enter[data-v-a55dea78],.list-leave-to[data-v-a55dea78]{opacity:0}',""]),e["default"]=r},9018:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".label[data-v-059eeb96]{display:block;overflow:hidden;max-height:70%;text-overflow:ellipsis}.scrollable[data-v-059eeb96] ul[role=menu]{max-height:50vh;overflow:auto}.scrollable[data-v-059eeb96] button.dropdown-toggle{display:flex;flex-direction:row;justify-content:space-between;align-items:center}",""]),e["default"]=r},3156:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".label[data-v-47cb2636]{display:block;overflow:hidden;max-height:70%;text-overflow:ellipsis}.scrollable[data-v-47cb2636] ul[role=menu]{max-height:50vh;overflow:auto}.scrollable[data-v-47cb2636] button.dropdown-toggle{display:flex;flex-direction:row;justify-content:space-between;align-items:center}",""]),e["default"]=r},1231:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,"#redcap-field-dropdown[data-v-791d3388] button.dropdown-toggle{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.label[data-v-791d3388]{display:block;overflow:hidden;max-height:70%;text-overflow:ellipsis}.scrollable[data-v-791d3388] ul[role=menu] .content{max-height:50vh;overflow:auto;max-width:50vw}.scrollable[data-v-791d3388] ul[role=menu] button[role=menuitem] span{overflow:hidden;text-overflow:ellipsis;width:100%}.scrollable[data-v-791d3388] button.dropdown-toggle{display:flex;flex-direction:row;justify-content:space-between;align-items:center}",""]),e["default"]=r},5876:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,"section[data-v-f6b38814]{display:contents}",""]),e["default"]=r},8393:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,".label[data-v-45462dce]{display:block;overflow:hidden;max-height:70%;text-overflow:ellipsis}.scrollable[data-v-45462dce]{flex:1}.delete-button[data-v-45462dce]{flex:0}.scrollable[data-v-45462dce] ul[role=menu]{max-height:50vh;overflow:auto}.scrollable[data-v-45462dce] button.dropdown-toggle{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%;flex:1;border-top-right-radius:0;border-bottom-right-radius:0}",""]),e["default"]=r},4310:function(t,e,s){"use strict";s.r(e);var a=s(8081),i=s.n(a),n=s(3645),o=s.n(n),r=o()(i());r.push([t.id,"label[data-v-2fd68bd7]{font-weight:700}table[data-v-2fd68bd7]{position:relative}tr td[data-v-2fd68bd7]:nth-child(2){width:50%}",""]),e["default"]=r},4821:function(t,e,s){var a=s(2545);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("5ffe7804",a,!0,{sourceMap:!1,shadowMode:!1})},9110:function(t,e,s){var a=s(7551);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("19890321",a,!0,{sourceMap:!1,shadowMode:!1})},3791:function(t,e,s){var a=s(1461);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("5958f468",a,!0,{sourceMap:!1,shadowMode:!1})},7377:function(t,e,s){var a=s(1734);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("46200e06",a,!0,{sourceMap:!1,shadowMode:!1})},6502:function(t,e,s){var a=s(164);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("2bae2c12",a,!0,{sourceMap:!1,shadowMode:!1})},9898:function(t,e,s){var a=s(3699);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("5319c6ae",a,!0,{sourceMap:!1,shadowMode:!1})},9726:function(t,e,s){var a=s(2049);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("617b745a",a,!0,{sourceMap:!1,shadowMode:!1})},174:function(t,e,s){var a=s(4021);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("42022197",a,!0,{sourceMap:!1,shadowMode:!1})},8564:function(t,e,s){var a=s(7150);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("3153ac25",a,!0,{sourceMap:!1,shadowMode:!1})},8077:function(t,e,s){var a=s(2760);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("3ec4c2e7",a,!0,{sourceMap:!1,shadowMode:!1})},7426:function(t,e,s){var a=s(9018);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("0c52fc92",a,!0,{sourceMap:!1,shadowMode:!1})},4102:function(t,e,s){var a=s(3156);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("61875b57",a,!0,{sourceMap:!1,shadowMode:!1})},3133:function(t,e,s){var a=s(1231);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("7bce0a4b",a,!0,{sourceMap:!1,shadowMode:!1})},6803:function(t,e,s){var a=s(5876);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("08e838d2",a,!0,{sourceMap:!1,shadowMode:!1})},723:function(t,e,s){var a=s(8393);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("44d84c2a",a,!0,{sourceMap:!1,shadowMode:!1})},6987:function(t,e,s){var a=s(4310);a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.id,a,""]]),a.locals&&(t.exports=a.locals);var i=s(4402).Z;i("d4aa135a",a,!0,{sourceMap:!1,shadowMode:!1})}}]);